<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>同时运动</title>
	<style>
	*{
		margin:0;
		padding:0;
	}
	#box{
		width:100px;
		height:100px;
		background:blue;
        margin-left: 900px;
        text-align: center;
        line-height: 100px;
	}
    #box1{
        width:100px;
        height:100px;
        background:yellow;
        margin-left: 900px;
    }
    #spa{
        display: none;
    }
	</style>
</head>
<body>
	<div id="box"><span id='spa'>我要飞</span></div>
    <div id="box1"></div>
    
	<script>

	var box=document.getElementById('box');
    var box1=document.getElementById('box1');
    var spans=document.getElementById('spa')
	var timer=null;
	box.onmouseover=function(){
        spans.style.display='block';
        
		startMove(box,{"width":300,"height":500},function(){
			startMove(box,{"opacity":20});
		})
	}
	box.onmouseout=function(){
        spans.style.display='none';
		startMove(box,{"width":100,"height":100},function(){
			startMove(box,{"opacity":90});
		})
	}

    box1.onmouseover=function(){
        startMove(box1,{"width":300,"height":500},function(){
            startMove(box1,{"opacity":20});
        })
    }
    box1.onmouseout=function(){
        startMove(box1,{"width":100,"height":100},function(){
            startMove(box1,{"opacity":90});
        })
    }

	function getStyle(obj, name)
{
    if(obj.currentStyle)
    {
        return obj.currentStyle[name];
    }
    else
    {
        return getComputedStyle(obj, false)[name];
    }
}


//startMove(oDiv, {width: 400, height: 400})


function startMove(obj, json, fnEnd)
{
    clearInterval(obj.timer);
    obj.timer=setInterval(function (){
        var bStop=true;        //假设：所有值都已经到了
        
        for(var attr in json)
        {
            var cur=0;
            
            if(attr=='opacity')
            {
                cur=Math.round(parseFloat(getStyle(obj, attr))*100);
            }
            else
            {
                cur=parseInt(getStyle(obj, attr));
            }
            
            var speed=(json[attr]-cur)/6;
            speed=speed>0?Math.ceil(speed):Math.floor(speed);
            
            if(cur!=json[attr])
                bStop=false;
            
            if(attr=='opacity')
            {
                obj.style.filter='alpha(opacity:'+(cur+speed)+')';
                obj.style.opacity=(cur+speed)/100;
            }
            else
            {
                obj.style[attr]=cur+speed+'px';
            }
        }
        
        if(bStop)
        {
            clearInterval(obj.timer);
                        
            if(fnEnd)fnEnd();
        }
    }, 30);
}
	</script>
</body>
</html>